--- 
id: 2951
name: Paso 2 - Datos del Solicitante
label: Datos del Solicitante
description: ""
fill_step_id: 1584
created_at: 2014-07-03 01:51:19 Z
updated_at: 2014-07-03 01:51:19 Z
include: "{\"4475\":{\"3208\":{\"1973\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"3638\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1469\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1470\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1471\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1472\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1473\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"3715\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1475\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1477\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1476\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1479\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"3694\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"3209\":{\"572\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"805\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"585\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"594\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"4476\":{\"3232\":{\"3648\":{\"views\":\"hidden\",\"enabled\":\"enabled\"},\"3650\":{\"views\":\"default\",\"enabled\":\"disabled\"}}},\"4477\":{\"3227\":{\"3710\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"3709\":{\"views\":\"hidden\",\"enabled\":\"enabled\"}}},\"4478\":{\"3261\":{\"3691\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"3693\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"3692\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"3712\":{\"views\":\"default\",\"enabled\":\"enabled\"}},\"3264\":{\"1227\":{\"views\":\"default\",\"enabled\":\"enabled\"}}}}"
allowed_next_to_steps: ""
allowed_back_to_steps: ""
controls: ,back,next,close,close_and_save,save
on_becoming: "### BUSQUEDA DE PERSONAS CON RECORD POLICIVO EN CURSO O VIGENTE ###\r\n\
  if  (@owner[\"kind_of_user_type\"] == \"JuridicalPerson\") || (@owner[\"kind_of_user_type\"] == \"NaturalPerson\")\r\n\
  \t_rp_vigente = false\r\n\
  \t(1..20).each do |_num|\r\n\
  \t#instance_num = \"_instance_#{_num}\"\r\n\
  \t\ttip_doc = form_data.get(\"tipo_de_persona_dij.tipo_de_identificacion_instance_#{_num}.tipo_identificacion\")\r\n\
  \t\tnro_doc = form_data.get(\"tipo_de_persona_dij.tipo_de_identificacion_instance_#{_num}.numero_documento\")\r\n\
  \t\tunless nro_doc.blank?\r\n\
  \t\t\t_rp_vigente = true ## INDICA QUE HAY AL MENOS UN RECORD POLICIVO\r\n\
  \t\t\tif tip_doc = \"C\xC3\xA9dula\"\r\n\
  \t\t\t\tresult = WebserviceConsumer.get( '/service/bdin_dij_datos_vigentes/find.json?tipoDocumento=CIP&nroDocumento=' + \"#{nro_doc}\").parsed_response\r\n\
  \t\t\t\t\tdata = result[\"response\"]\r\n\
  \t\t\t\tif !data.blank?\r\n\
  \t\t\t\t\tform_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.cedula_pasaporte\",nro_doc)\r\n\
  \t\t\t\t\tform_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.tipo_documento\",tip_doc)\r\n\
  \t\t\t\t\tform_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.primer_nombre\",data[\"PrimerNombre\"])\r\n\
  \t\t\t\t\tform_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.primer_apellido\",data[\"PrimerApellido\"])\r\n\
  \t\t\t\t\trec_vig = data[\"recordVigente\"]\r\n\
  \t\t\t\t\t\tif rec_vig = true\r\n\
  \t\t\t\t\t\t\t_rv = \"Record Vigente\"\r\n\
  \t\t\t\t\t\t\tform_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.campo_oculto\",_rv)\r\n\
  \t\t\t\t\t\tend\r\n\
  \t\t\t\t\trec_cur = data[\"recordCurso\"]\r\n\
  \t\t\t\t\t\tif rec_cur = true\r\n\
  \t\t\t\t\t\t\t_rc = \"Record en Curso\"\r\n\
  \t\t\t\t\t\t\tform_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.campo_oculto\",_rc)\r\n\
  \t\t\t\t\t\tend\r\n\
  \t\t\t\telse\r\n\
  \t\t\t\t\t_rp = \"No tiene Record Policivo\"\r\n\
  \t\t\t\t       form_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.campo_oculto\",_rp)\r\n                                       form_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.cedula_pasaporte\",nro_doc)\r\n                                       form_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.tipo_documento\",tip_doc)\r\n                                       form_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.primer_nombre\")\r\n                                       form_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.primer_apellido\")\r\n\
  \t\t\t\tend\r\n\
  \t\t\telse                                      \r\n\
  \t\t\t\tresult = WebserviceConsumer.get('/service/bdin_dij_datos_vigentes/find.json?tipoDocumento=PAS&nroDocumento=' + \"#{nro_doc}\").parsed_response\r\n\
  \t\t\t\t_datap = result[\"response\"]\t\r\n\
  \t\t\t\tif !datap.blank?\r\n\
  \t\t\t\t\tform_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.cedula_pasaporte\",nro_doc)\r\n\
  \t\t\t\t\tform_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.tipo_documento\",tip_doc)\r\n\
  \t\t\t\t\tform_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.primer_nombre\",datap[\"PrimerNombre\"])\r\n\
  \t\t\t\t\tform_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.primer_apellido\",datap[\"PrimerApellido\"])\r\n\
  \t\t\t\t\trec_vig = datap[\"recordVigente\"]\r\n\
  \t\t\t\t\t\tif rec_vig = true\r\n\
  \t\t\t\t\t\t\t_rv = \"Record Vigente\"\r\n\
  \t\t\t\t\t\t\tform_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.campo_oculto\",_rv)\r\n\
  \t\t\t\t\t\tend\r\n\
  \t\t\t\t\trec_cur = datap[\"recordCurso\"]\r\n\
  \t\t\t\t\t\tif rec_cur = true\r\n\
  \t\t\t\t\t\t\t_rc = \"Record en Curso\"\r\n\
  \t\t\t\t\t\t\tform_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.campo_oculto\",_rc)\r\n\
  \t\t\t\t\t\tend\r\n\
  \t\t\t\telse\r\n\
  \t\t\t\t\t_rp = \"No tiene Record Policivo\"\r\n\
  \t\t\t\t       form_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.campo_oculto\",_rp)\r\n                                       form_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.cedula_pasaporte\",nro_doc)\r\n                                       form_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.tipo_documento\",tip_doc)\r\n                                       form_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.primer_nombre\")\r\n                                       form_data.set(\"datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.primer_apellido\")\r\n\
  \t\t\t\tend\r\n\
  \t\t\tend\t\r\n\
  \t\tend\r\n  \tend\r\n\
  end\r\n\
  \r\n\
  \r\n\
  _tabla = \"Ver Listado de Record Policivo en Tabla\"\r\n\
  form_data.set(\"mensaje_dij.mensaje_dij.record_policivo\", _tabla)\r\n\
  \r\n\
  _tablados = \"Ver Listado de Titulares no Registrados\"\r\n\
  form_data.set(\"tabla_solicitantes.tabla_dinamica.mensaje\", _tablados)\r\n\
  \r\n "
on_transition: |-
  #if  @owner["kind_of_user_type"] == "JuridicalPerson"
    # form_data.set("tipo_de_persona_dij.pregunta.si_no","JuridicalPerson")
  #end
  
  # TRAMITE EN CURSO, VIGENTE             # VALIDA DATOS EN TE                 # PERSONA NATURAL
  ###################################################################
  # P6
  
  if @owner["kind_of_user_type"] == "NaturalPerson"
  	if @owner["natural_person_type"]=="national_citizen"
  		nro_documento=@owner["national_id"]
          tipo_documento="Cedula"
  		dato="true"
  			result = WebserviceConsumer.get('/service/bdin_dij_datos_vigentes/find.json?tipoDocumento=CIP&nroDocumento=' + "#{nro_documento}").parsed_response
  	        _solicitante = result["response"]
  			record = _solicitante["recordVigente"]
  			curso = _solicitante["recordCurso"]
  				if record == "true"
  					form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.cedula_pasaporte","")
  					rp_vigente = _solicitante["recordVigente"]
  					if rp_vigente == "true"
  						vigente = "Record Vigente"
  						form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.campo_oculto",vigente)
  					end
  				end
  					if curso == "true"
  						form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.cedula_pasaporte","")
  						rp_curso = _solicitante["recordCurso"]
  						if rp_curso == "true"
  							curso = "Record en Curso"
  							form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.campo_oculto",curso)
  						end
  					end
  		
  		    		result = WebserviceConsumer.get( '/service/bdin_tribunal_electoral/find.json?cedula=' + "#{nro_documento}").parsed_response
  		    		data = result["response"]
  						if data.nil? 
  							transition_errors << "Los datos del solicitante no fueron encontrados, por favor verifique."
  						else
  							form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.tipo_documento",tipo_documento)
  							form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.cedula_pasaporte",data["cedula"])
  							form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.primer_nombre",data["primerNombre"])
  							form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.segundo_nombre",data["segundoNombre"])
  							form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.primer_apellido",data["primerApellido"])
  							form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.segundo_apellido",data["segundoApellido"])
  							form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.apellido_de_casada",data["apellidoCasada"])
  							form_data.set("datos_del_solicitante_dij_instance_1.datos_de_ubicacion.direccion",data["direccionNacimiento"])
  							form_data.set("datos_del_solicitante_dij_instance_1.datos_de_ubicacion.numero_de_telefono",data["tlfLocal"])
  							form_data.set("datos_del_solicitante_dij_instance_1.datos_de_ubicacion.correo_electronico",data["email"])
  							form_data.set("datos_del_solicitante_dij_instance_1.datos_de_ubicacion.pais",data["pais"])
  							form_data.set("datos_del_padre_instance_1.datos_de_la_persona.primer_nombre",data["primerNombrePadre"])
  							form_data.set("datos_del_padre_instance_1.datos_de_la_persona.primer_apellido",data["apellidoPaternoPadre"])
  							form_data.set("datos_de_la_madre_instance_1.datos_de_la_persona.primer_nombre",data["primerNombreMadre"])
  							form_data.set("datos_de_la_madre_instance_1.datos_de_la_persona.primer_apellido",data["apellidoPaternoMadre"])
  							form_data.set("datos_del_padre_instance_1.datos_de_la_persona.documento_hijo",nro_documento)
  							form_data.set("datos_de_la_madre_instance_1.datos_de_la_persona.documento_hijo",nro_documento)
  							fecha = data["fechaNacimiento"]
  							fecha_n = Time.parse(fecha).strftime("%d-%m-%Y")
  							form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.fecha_de_nacimiento",fecha_n)
  
  							edad = ((Date.today - fecha_n.to_date).to_f / 365).to_i
  							form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.edad",edad)
  						end        
  	    
  		else
  			nro_documento=@owner["passport"]
  			tipo_documento="Pasaporte"	
  			result = WebserviceConsumer.get('/service/bdin_dij_datos_vigentes/find.json?tipoDocumento=PAS&nroDocumento=' + "#{nro_documento}").parsed_response
  	        _solicitante = result["response"]
  			record=_solicitante["recordVigente"]
  			curso = _solicitante["recordCurso"]
  			if record=="true"
  				rp_vigente = _solicitante["recordVigente"]
  				if rp_vigente == "true"
  					vigente = "Record Vigente"
  					form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.campo_oculto",vigente)
  				end
  				form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.cedula_pasaporte",nro_documento)
  				form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.tipo_documento",tipo_documento)
  				form_data.set("datos_del_padre_instance_1.datos_de_la_persona.documento_hijo",nro_documento)
  				form_data.set("datos_de_la_madre_instance_1.datos_de_la_persona.documento_hijo",nro_documento)
  	    	else
  				dato="false"
  	            form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.cedula_pasaporte",nro_documento)
  				form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.tipo_documento",tipo_documento)
  				form_data.set("datos_del_padre_instance_1.datos_de_la_persona.documento_hijo",nro_documento)
  				form_data.set("datos_de_la_madre_instance_1.datos_de_la_persona.documento_hijo",nro_documento)
  			end		
  			if curso=="true"
  				rp_curso = _solicitante["recordCurso"]
  				if rp_curso == "true"
  					_curso = "Record en Curso"
  					form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.campo_oculto",_curso)
  				end
  				form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.cedula_pasaporte",nro_documento)
  				form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.tipo_documento",tipo_documento)
  				form_data.set("datos_del_padre_instance_1.datos_de_la_persona.documento_hijo",nro_documento)
  				form_data.set("datos_de_la_madre_instance_1.datos_de_la_persona.documento_hijo",nro_documento)
  	    	else
  				dato="false"
  	            form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.cedula_pasaporte",nro_documento)
  				form_data.set("datos_del_solicitante_dij_instance_1.datos_basicos_de_persona_natural.tipo_documento",tipo_documento)
  				form_data.set("datos_del_padre_instance_1.datos_de_la_persona.documento_hijo",nro_documento)
  				form_data.set("datos_de_la_madre_instance_1.datos_de_la_persona.documento_hijo",nro_documento)
  			end
  		end
  	end 
  
  
  if  (@owner["kind_of_user_type"] == "JuridicalPerson") || (@owner["kind_of_user_type"] == "NaturalPerson")
    # _ruc = @owner["tax_id"]
  		rp_vigente = "true"
  		(1..20).each do |_num|
  			tipo_documento = form_data.get("tipo_de_persona_dij.tipo_de_identificacion_instance_#{_num}.tipo_identificacion")
  			nro_documento = form_data.get("tipo_de_persona_dij.tipo_de_identificacion_instance_#{_num}.numero_documento")
  			if (!nro_documento.blank? && !tipo_documento.blank?)
  				# if tipo_documento == "Cedula"  
  				# 	result = WebserviceConsumer.get('/service/bdin_dij_datos_vigentes/find.json?tipoDocumento=CIP&nroDocumento=' + "#{nro_documento}").parsed_response
  				# 	_solicit = result["response"]
  				# 	record = _solicit["recordVigente"]
  				# 	curso = _solicit["recordCurso"]
  				# 		if record == "true"
  				# 			form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.cedula_pasaporte","")
  				# 			rp_vigente = _solicit["recordVigente"]
  				# 			if rp_vigente == "true"
  				# 				vigente = "Record Vigente"
  				# 				form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.campo_oculto",vigente)
  				# 			end
  				# 		end
  				# 			if curso == "true"
  				# 				form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.cedula_pasaporte","")
  				# 				rp_curso = _solicit["recordCurso"]
  				# 				if rp_curso == "true"
  				# 					curso = "Record en Curso"
  				# 					form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.campo_oculto",curso)
  				# 				end
  				# 			end
  				# else                                       
  				# 	result = WebserviceConsumer.get('/service/bdin_dij_datos_vigentes/find.json?tipoDocumento=PAS&nroDocumento=' + "#{nro_documento}").parsed_response
  				# 	_solicitan = result["response"]				
  				# 	record = _solicitan["recordVigente"]
  				# 		curso = _solicitan["recordCurso"]
  				# 		if record == "true"
  				# 			form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.cedula_pasaporte","")
  				# 			rp_vigente = _solicitan["recordVigente"]
  				# 			if rp_vigente == "true"
  				# 				vigente = "Record Vigente"
  				# 				form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.campo_oculto",vigente)
  				# 			end
  				# 		end
  				# 			if curso == "true"
  				# 				form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.cedula_pasaporte","")
  				# 				rp_curso = _solicitan["recordCurso"]
  				# 				if rp_curso == "true"
  				# 					curso = "Record en Curso"
  				# 					form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.campo_oculto",curso)
  				# 				end
  				# 			end
  				# end
  
  			if tipo_documento == "Cedula"
  				result = WebserviceConsumer.get( '/service/bdin_tribunal_electoral/find.json?cedula=' + "#{nro_documento}").parsed_response
  				data = result["response"]
  				if data.blank?
  					form_data.set("tipo_de_persona_dij.tipo_de_identificacion_instance_#{_num}.numero_documento","")				
  					transition_errors << "Los datos del solicitante #{_num}, no fueron encontrados, por favor verifique."
  				else
  					form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.tipo_documento",tipo_documento)
  					form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.cedula_pasaporte",data["cedula"])
  					form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.primer_nombre",data["primerNombre"])
  					form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.segundo_nombre",data["segundoNombre"])
  					form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.primer_apellido",data["primerApellido"])
  					form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.segundo_apellido",data["segundoApellido"])
  					form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.apellido_de_casada",data["apellidoCasada"])
  					form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_de_ubicacion.direccion",data["direccionNacimiento"])
  					form_data.set("datos_del_padre_instance_#{_num}.datos_de_la_persona.documento_hijo",data["cedula"])
  					form_data.set("datos_del_padre_instance_#{_num}.datos_de_la_persona.primer_nombre",data["primerNombrePadre"])
  					form_data.set("datos_del_padre_instance_#{_num}.datos_de_la_persona.primer_apellido",data["apellidoPaternoPadre"])
  					form_data.set("datos_de_la_madre_instance_#{_num}.datos_de_la_persona.documento_hijo",data["cedula"])
  					form_data.set("datos_de_la_madre_instance_#{_num}.datos_de_la_persona.primer_nombre",data["primerNombreMadre"])
  					form_data.set("datos_de_la_madre_instance_#{_num}.datos_de_la_persona.primer_apellido",data["apellidoPaternoMadre"])
  					# CONVERSION FECHA DE NACIEMIENTO #
  					fecha = data["fechaNacimiento"]
  					fecha_n = Time.parse(fecha).strftime("%d-%m-%Y")
  					form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.fecha_de_nacimiento",fecha_n)
  					# VALIDA EDAD #
  					edad = ((Date.today - fecha.to_date).to_f / 365).to_i
  					form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.edad",edad)
  				end			 
  			else
  				form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.cedula_pasaporte",nro_documento)
  				form_data.set("datos_del_solicitante_dij_instance_#{_num}.datos_basicos_de_persona_natural.tipo_documento",tipo_documento)
  				form_data.set("datos_del_padre_instance_#{_num}.datos_de_la_persona.documento_hijo",nro_documento)
  				form_data.set("datos_de_la_madre_instance_#{_num}.datos_de_la_persona.documento_hijo",nro_documento)				
  			end
  		end
  	end			
  end
views: 
back_step: Paso 1 - Ingresar tipo de Solicitante y de Solicitud
next_step: Paso 3 - Adjuntar archivos
position: 2
ajax_calls: |
  //////Habilitar campos si tipo documento es pasaporte
  	$.each( $('[id*=datos_del_solicitante_dij_]'), function(index, campo) {
  		
  				var pos = (this.id).match(/_instance_[\d][\d]/);
  				if (pos == null){
  					pos = (this.id).match(/_instance_[\d]/);
  				}	
  	
  				var autor = "#field_datos_del_solicitante_dij";
  				var mod1 = autor.concat(pos);
  	
  				var docs = "_datos_basicos_de_persona_natural_tipo_documento";
  				var nom1 = "_datos_basicos_de_persona_natural_primer_nombre";
  				var nom2 = "_datos_basicos_de_persona_natural_segundo_nombre";
  				var ape1 = "_datos_basicos_de_persona_natural_primer_apellido";
  				var ape2 = "_datos_basicos_de_persona_natural_segundo_apellido";
  				var apec = "_datos_basicos_de_persona_natural_apellido_de_casada";
  				var nac  = "_datos_basicos_de_persona_natural_nacionalidad";
  				var fec  = "_datos_basicos_de_persona_natural_fecha_de_nacimiento";
  	
  				var documento_d = mod1.concat(docs);
  				var nombre1_d = mod1.concat(nom1);
  				var nombre2_d = mod1.concat(nom2);
  				var apellido1_d = mod1.concat(ape1);
  				var apellido2_d = mod1.concat(ape2);
  				var apellidocasada = mod1.concat(apec);
  				var nacimiento = mod1.concat(nac);
  				var fecha_naci = mod1.concat(fec);
  					
  						if($(documento_d).val() == 'Pasaporte'){
  							$(nombre1_d).removeAttr("disabled");
  							$(nombre2_d).removeAttr("disabled");
  							$(apellido1_d).removeAttr("disabled");
  							$(apellido2_d).removeAttr("disabled");
  							$(apellidocasada).removeAttr("disabled");
  							$(nacimiento).removeAttr("disabled");
  							$(fecha_naci).removeAttr("disabled");
  						}
  });
  
  
  ///////////////////// Ocultar botones agregar eliminar
  
  $(document).ready(function(){
  $.each( $('[id*=datos_del_solicitante_dij_]'), function(index, campo) {
  
   var pos = (this.id).match(/_instance_[\d][\d]/);
   if (pos == null){
     pos = (this.id).match(/_instance_[\d]/);
   }
   //alert(pos);
   var mod1 = "#field_datos_del_solicitante_dij";
   var mod2 = "_datos_basicos_de_persona_natural_cedula_pasaporte";
   var mod3 = mod1.concat(pos);
   var dato = mod3.concat(mod2);
   $(dato).parents(".section-box").next().hide()
    });
  });
  
  //Ocultar botones padres
  $(document).ready(function(){
  $.each( $('[id*=datos_del_padre_]'), function(index, campo) {
  
   var pos = (this.id).match(/_instance_[\d][\d]/);
   if (pos == null){
     pos = (this.id).match(/_instance_[\d]/);
   }
   //alert(pos);
   var mod1 = "#field_datos_del_padre";
   var mod2 = "_datos_de_la_persona_documento_hijo";
   var mod3 = mod1.concat(pos);
   var dato = mod3.concat(mod2);
  
   $(dato).parents(".section-box").next().hide()
    });
    });
  
  $(document).ready(function(){
  $.each( $('[id*=datos_de_la_madre_]'), function(index, campo) {
  
   var pos = (this.id).match(/_instance_[\d][\d]/);
   if (pos == null){
     pos = (this.id).match(/_instance_[\d]/);
   }
   //alert(pos);
   var mod1 = "#field_datos_de_la_madre";
   var mod2 = "_datos_de_la_persona_documento_hijo";
   var mod3 = mod1.concat(pos);
   var dat = mod3.concat(mod2);
  
   $(dat).parents(".section-box").next().hide()
    });
  });
  
  
  // TABLA DEL LISTADO DE RECORD POLICIVO //
  // parametros = tipoDocumento, nroDocumento
  
  $(document).ready(function(){
  elementos = [];
  for(_num = 1; _num <= 20; _num ++){
  var num_doc = $("field_tipo_de_persona_dij_tipo_de_identificacion_instance_"+_num+"_numero_documento").val();
  var tipo_doc = $("input[name='[field][tipo_de_persona_dij_tipo_de_identificacion_instance_"+_num+"_tipo_identificacion]']:checked").val();
  var doc = ""
  if(tipo_doc == "Cedula"){
  	doc = "CIP"
  }else if(tipo_doc == "Pasaporte"){
  	doc = "PAS"
  }
  
  // cambiar donde dice nombre_del_servicio por el verdadero nombre del servicio
  params = {"service_name":"bdin_dij_datos_vigentes/where",tipoDocumento:doc, nroDocumento:num_doc};
  
  //campo que quieres incluir en la tabla
  nombres_columna = ["tipoDocumento","nroDocumento","primerNombre","segundoNombre","primerApellido","segundoApellido","apellidoCasada","recordVigente","recordCurso"];
  //invocacion del servicio
  $.post("/proxy_service/get_service",
      params,
      function(data){
       	fila = [];
        $.each(data,function(key,value){
          if($.inArray(key,nombres_columna) != -1){
       			fila.push({column_name:key,
            		  	   column_value:value,
                		   editable:false});
            }
        });
    elementos.push(fila);
  });
  }
  showMultipleInstancesOnTable(elementos, 1,"Listado de Record Policivo", "mensaje_dij", "field_mensaje_dij_mensaje_dij_campo_oculto");
  });
  
  
  
  // TABLA DE TITULARES REGISTRADOS EN PSP //
  // TABLA DEL LISTADO DE RECORD POLICIVO //
  // parametros = tipoDocumento, nroDocumento
  
  $(document).ready(function(){
  elementos = [];
  for(_num = 1; _num <= 20; _num ++){
  var num_doc = $("field_tipo_de_persona_dij_tipo_de_identificacion_instance_"+_num+"_numero_documento").val();
  var tipo_doc = $("input[name='[field][tipo_de_persona_dij_tipo_de_identificacion_instance_"+_num+"_tipo_identificacion]']:checked").val();
  var doc = ""
  if(tipo_doc == "Cedula"){
  	doc = "CIP"
  }else if(tipo_doc == "Pasaporte"){
  	doc = "PAS"
  }
  
  // cambiar donde dice nombre_del_servicio por el verdadero nombre del servicio
  params = {"service_name":"bdin_dij_datos_vigentes/where",tipoDocumento:doc, nroDocumento:num_doc};
  
  //campo que quieres incluir en la tabla
  nombres_columna = ["tipoDocumento","nroDocumento","primerNombre","segundoNombre","primerApellido","segundoApellido","apellidoCasada","recordVigente","recordCurso"];
  //invocacion del servicio
  $.post("/proxy_service/get_service",
      params,
      function(data){
       	fila = [];
        $.each(data,function(key,value){
          if($.inArray(key,nombres_columna) != -1){
       			fila.push({column_name:key,
            		  	   column_value:value,
                		   editable:false});
            }
        });
    elementos.push(fila);
  });
  }
  showMultipleInstancesOnTable(elementos, 1,"Listado de Titulares no registrados", "tabla_solicitantes", "field_tabla_solicitantes_tabla_dinamica_campo_oculto");
  });

