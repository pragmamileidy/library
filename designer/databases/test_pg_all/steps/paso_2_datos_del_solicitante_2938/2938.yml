--- 
id: 2938
name: Paso 2 - Datos del Solicitante
label: Datos del Solicitante
description: ""
fill_step_id: 1576
created_at: 2014-07-01 19:13:40 Z
updated_at: 2014-07-01 19:13:40 Z
include: "{\"4438\":{\"3213\":{\"2929\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"2930\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"3631\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"4439\":{\"3208\":{\"1973\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"3638\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1469\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1470\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1471\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1472\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1473\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1474\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1475\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1477\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1476\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1479\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"3694\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"3209\":{\"572\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"805\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"585\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"594\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"4440\":{\"2631\":{\"567\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"566\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"3254\":{\"views\":\"default\",\"enabled\":\"enabled\"}},\"2632\":{\"805\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"585\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"594\":{\"views\":\"default\",\"enabled\":\"disabled\"}}},\"4441\":{\"1444\":{\"3651\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"528\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"529\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"530\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"537\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"4442\":{\"1444\":{\"3651\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"528\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"529\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"530\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"537\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"926\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"4445\":{\"3261\":{\"3691\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"3693\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"3692\":{\"views\":\"default\",\"enabled\":\"enabled\"}},\"3264\":{\"1227\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"4446\":{\"2860\":{\"3374\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"4452\":{\"3227\":{\"3710\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"3709\":{\"views\":\"hidden\",\"enabled\":\"enabled\"}}}}"
allowed_next_to_steps: ""
allowed_back_to_steps: ""
controls: ,back,next,close,close_and_save,save
on_becoming: |-
  if  @owner["kind_of_user_type"] == "JuridicalPerson"
  	_ruc = @owner["tax_id"]
  
  	form_data.set("datos_del_solicitante_persona_juridica.datos_persona_juridica.ruc",_ruc)
  	form_data.set("datos_del_solicitante_persona_juridica.datos_persona_juridica.nombre",@owner["name"])
  	form_data.set("datos_del_solicitante_persona_juridica.datos_de_ubicacion.numero_de_telefono",@owner["fixed_number"])
  	form_data.set("datos_del_solicitante_persona_juridica.datos_de_ubicacion.correo_electronico",@owner["email"])
  	form_data.set("datos_del_solicitante_persona_juridica.datos_de_ubicacion.direccion",@owner["full_address"])
  end
  
  
  _tabla = "Ver Listado de Record Policivo en Tabla"
  form_data.set("mensaje_dij.mensaje_dij.record_policivo", _tabla)
on_transition: "\r\n\
  \r\n\
  \r\n\
  \r\n\
  \r\n\
  \r\n"
views: 
back_step: Paso 1 - Ingresar tipo de Solicitante y de Solicitud
next_step: Paso 3 - Adjuntar archivos
position: 2
ajax_calls: |
  //////Habilitar campos si tipo documento es pasaporte
  	$.each( $('[id*=datos_del_solicitante_dij_]'), function(index, campo) {
  		
  				var pos = (this.id).match(/_instance_[\d][\d]/);
  				if (pos == null){
  					pos = (this.id).match(/_instance_[\d]/);
  				}	
  	
  				var autor = "#field_datos_del_solicitante_dij";
  				var mod1 = autor.concat(pos);
  	
  				var docs = "_datos_basicos_de_persona_natural_tipo_documento";
  				var nom1 = "_datos_basicos_de_persona_natural_primer_nombre";
  				var nom2 = "_datos_basicos_de_persona_natural_segundo_nombre";
  				var ape1 = "_datos_basicos_de_persona_natural_primer_apellido";
  				var ape2 = "_datos_basicos_de_persona_natural_segundo_apellido";
  				var apec = "_datos_basicos_de_persona_natural_apellido_de_casada";
  				var nac  = "_datos_basicos_de_persona_natural_nacionalidad";
  				var fec  = "_datos_basicos_de_persona_natural_fecha_de_nacimiento";
  	
  				var documento_d = mod1.concat(docs);
  				var nombre1_d = mod1.concat(nom1);
  				var nombre2_d = mod1.concat(nom2);
  				var apellido1_d = mod1.concat(ape1);
  				var apellido2_d = mod1.concat(ape2);
  				var apellidocasada = mod1.concat(apec);
  				var nacimiento = mod1.concat(nac);
  				var fecha_naci = mod1.concat(fec);
  					
  						if($(documento_d).val() == 'Pasaporte'){
  							$(nombre1_d).removeAttr("disabled");
  							$(nombre2_d).removeAttr("disabled");
  							$(apellido1_d).removeAttr("disabled");
  							$(apellido2_d).removeAttr("disabled");
  							$(apellidocasada).removeAttr("disabled");
  							$(nacimiento).removeAttr("disabled");
  							$(fecha_naci).removeAttr("disabled");
  						}
  });
  
  
  ///////////////////// Ocultar botones agregar eliminar
  
  $(document).ready(function(){
  $.each( $('[id*=datos_del_solicitante_dij_]'), function(index, campo) {
  
   var pos = (this.id).match(/_instance_[\d][\d]/);
   if (pos == null){
     pos = (this.id).match(/_instance_[\d]/);
   }
   //alert(pos);
   var mod1 = "#field_datos_del_solicitante_dij";
   var mod2 = "_datos_basicos_de_persona_natural_cedula_pasaporte";
   var mod3 = mod1.concat(pos);
   var dato = mod3.concat(mod2);
   $(dato).parents(".section-box").next().hide()
    });
  });
  
  //Ocultar botones padres
  $(document).ready(function(){
  $.each( $('[id*=datos_del_padre_]'), function(index, campo) {
  
   var pos = (this.id).match(/_instance_[\d][\d]/);
   if (pos == null){
     pos = (this.id).match(/_instance_[\d]/);
   }
   //alert(pos);
   var mod1 = "#field_datos_del_padre";
   var mod2 = "_datos_de_la_persona_documento_hijo";
   var mod3 = mod1.concat(pos);
   var dato = mod3.concat(mod2);
  
   $(dato).parents(".section-box").next().hide()
    });
    });
  
  $(document).ready(function(){
  $.each( $('[id*=datos_de_la_madre_]'), function(index, campo) {
  
   var pos = (this.id).match(/_instance_[\d][\d]/);
   if (pos == null){
     pos = (this.id).match(/_instance_[\d]/);
   }
   //alert(pos);
   var mod1 = "#field_datos_de_la_madre";
   var mod2 = "_datos_de_la_persona_documento_hijo";
   var mod3 = mod1.concat(pos);
   var dat = mod3.concat(mod2);
  
   $(dat).parents(".section-box").next().hide()
    });
  });
  
  
  // TABLA DEL LISTADO DE RECORD POLICIVO //
  // parametros = tipoDocumento, nroDocumento
  
  $(document).ready(function(){
  elementos = [];
  for(_num = 1; _num <= 20; _num ++){
  var num_doc = $("field_tipo_de_persona_dij_tipo_de_identificacion_instance_"+_num+"_numero_documento").val();
  var tipo_doc = $("input[name='[field][tipo_de_persona_dij_tipo_de_identificacion_instance_"+_num+"_tipo_identificacion]']:checked").val();
  var doc = ""
  if(tipo_doc == "Cedula"){
  	doc = "CIP"
  }else if(tipo_doc == "Pasaporte"){
  	doc = "PAS"
  }
  
  // cambiar donde dice nombre_del_servicio por el verdadero nombre del servicio
  params = {"service_name":"bdin_dij_datos_vigentes/where",tipoDocumento:doc, nroDocumento:num_doc};
  
  //campo que quieres incluir en la tabla
  nombres_columna = ["tipoDocumento","nroDocumento","primerNombre","segundoNombre","primerApellido","segundoApellido","apellidoCasada","recordVigente","recordCurso"];
  //invocacion del servicio
  $.post("/proxy_service/get_service",
      params,
      function(data){
       	fila = [];
        $.each(data,function(key,value){
          if($.inArray(key,nombres_columna) != -1){
       			fila.push({column_name:key,
            		  	   column_value:value,
                		   editable:false});
            }
        });
    elementos.push(fila);
  });
  }
  showMultipleInstancesOnTable(elementos, 1,"Listado de Record Policivo", "mensaje_dij", "field_mensaje_dij_mensaje_dij_campo_oculto");
  });

