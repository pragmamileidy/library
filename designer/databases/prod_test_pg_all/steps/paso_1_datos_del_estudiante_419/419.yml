--- 
id: 419
name: Paso 1 - Datos del Estudiante
label: Datos del Estudiante
description: ""
fill_step_id: 221
created_at: 2012-05-31 19:29:27 Z
updated_at: 2013-05-14 21:14:23 Z
include: "{\"1169\":{\"1725\":{\"1468\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1478\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1469\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1470\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1471\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1472\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1473\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1474\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2047\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1477\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1476\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"2048\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1488\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"1726\":{\"574\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"632\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"633\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"583\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"581\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"585\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"631\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"594\":{\"views\":\"default\",\"enabled\":\"enabled\"}},\"1727\":{\"1483\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1489\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1484\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1485\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1486\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"1174\":{\"1725\":{\"1468\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"1175\":{\"1725\":{\"1468\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"1178\":{\"909\":{\"2005\":{\"views\":\"default\",\"enabled\":\"enabled\"}}}}"
allowed_next_to_steps: ""
allowed_back_to_steps: ""
controls: ,next,close,close_and_save,save
on_becoming: "#Falta: Seguro social, Edad, Nacionalidad, Estado Civil, @owner[\"birthday\"], fecha nac\r\n\
  form_data.set(\"datos_del_estudiante.datos_basicos.cedula\",@owner[\"national_id\"])\r\n\
  result = WebserviceConsumer.get( '/service/bdin_caja_seguro_social_obtener_datosdel_asegurado/find.json?cedula=' + \"#{@owner[\"national_id\"]}\").parsed_response\r\n\
  ss = result[\"response\"]\r\n\
  if !ss.nil?\r\n\
  \tform_data.set(\"datos_del_estudiante.datos_basicos.numero_de_seguro_social\",ss[\"nroSeguro\"])\r\n\
  end\r\n\
  form_data.set(\"datos_del_estudiante.datos_basicos.primer_nombre\",@owner[\"first_name\"])\r\n\
  form_data.set(\"datos_del_estudiante.datos_basicos.segundo_nombre\",@owner[\"second_name\"])\r\n\
  form_data.set(\"datos_del_estudiante.datos_basicos.primer_apellido\",@owner[\"last_name\"])\r\n\
  form_data.set(\"datos_del_estudiante.datos_basicos.segundo_apellido\",@owner[\"second_last_name\"])\r\n\
  form_data.set(\"datos_del_estudiante.datos_basicos.apellido_de_casada\",@owner[\"married_name\"])\r\n\
  form_data.set(\"datos_del_estudiante.datos_basicos.nacionalidad\",@owner[\"citizen_ship\"])\r\n\
  if @owner[\"gender\"]==\"male\"\r\n\
  sexo = \"Masculino\"\r\n\
  else\r\n\
  sexo= \"Femenino\"\r\n\
  end\r\n\
  form_data.set(\"datos_del_estudiante.datos_basicos.sexo_string\",sexo)\r\n\
  edad = ((Date.today - @owner[\"birthday\"].to_date).to_f / 365).to_i\r\n\
  form_data.set(\"datos_del_estudiante.datos_basicos.edad\",edad)\r\n\
  #form_data.set(\"datos_del_estudiante.datos_basicos.estado_civil\",\"Soltero(a)\")\r\n\
  form_data.set(\"datos_del_estudiante.datos_basicos.fecha_de_nacimiento_string\",@owner[\"birthday\"])\r\n\
  form_data.set(\"datos_del_estudiante.datos_basicos.lugar_de_nacimiento\",@owner[\"birth_country\"])\r\n\
  \r\n\
  # Revisar los datos asignados a los campos... Y falta distrito, corregimiento, barrio, numero de casa apartamento\r\n\
  form_data.set(\"datos_del_estudiante.direccion_actual.provincia\",@owner[\"province\"])\r\n\
  form_data.set(\"datos_del_estudiante.direccion_actual.numero_de_telefono\",@owner[\"fixed_number\"])\r\n\
  form_data.set(\"datos_del_estudiante.direccion_actual.numero_celular\",@owner[\"movil_number\"])\r\n\
  form_data.set(\"datos_del_estudiante.direccion_actual.correo_electronico\",@owner[\"email\"])\r\n\
  \r\n\
  #Datos adicionales tra\xC3\xADdos del servicio\r\n\
  _ci = @owner[\"national_id\"]\r\n\
  result = WebserviceConsumer.get( '/service/bdin_tribunal_electoral/find.json?cedula=' + \"#{_ci}\").parsed_response\r\n\
  datos = result[\"response\"]\r\n\
  if !datos.nil?\r\n\
  form_data.set(\"datos_del_estudiante.direccion_actual.distrito\", datos[\"distrito\"])\r\n\
  form_data.set(\"datos_del_estudiante.direccion_actual.corregimiento\", datos[\"corregimiento\"])\r\n\
  form_data.set(\"datos_del_estudiante.direccion_actual.barrio\", @owner[\"dwelling\"])\r\n\
  form_data.set(\"datos_del_estudiante.direccion_actual.numero_de_casa_apartamento\", datos[\"nroCasaApartamento\"])\r\n\
  end"
on_transition: |
  #DATOS DEL PADRE
  ci = form_data.get("datos_del_padre.datos_basicos.cedula")
  result = WebserviceConsumer.get( '/service/bdin_tribunal_electoral/find.json?cedula=' + "#{ci}").parsed_response
  datos = result["response"]
  if !datos.nil?
  	form_data.set("datos_del_padre.datos_basicos.primer_nombre", datos["primerNombre"])
  	form_data.set("datos_del_padre.datos_basicos.segundo_nombre", datos["segundoNombre"])
  	form_data.set("datos_del_padre.datos_basicos.primer_apellido", datos["primerApellido"])
  	form_data.set("datos_del_padre.datos_basicos.segundo_apellido", datos["segundoApellido"])
  else
  	transition_errors << "Los datos del padre no fueron encontrados, por favor verifique.\n"
  end
  	
  #DATOS DE LA MADRE
  ci = form_data.get("datos_de_la_madre.datos_basicos.cedula")
  result = WebserviceConsumer.get( '/service/bdin_tribunal_electoral/find.json?cedula=' + "#{ci}").parsed_response
  datos = result["response"]
  if !datos.nil?
  	form_data.set("datos_de_la_madre.datos_basicos.primer_nombre", datos["primerNombre"])
  	form_data.set("datos_de_la_madre.datos_basicos.segundo_nombre", datos["segundoNombre"])
  	form_data.set("datos_de_la_madre.datos_basicos.primer_apellido", datos["primerApellido"])
  	form_data.set("datos_de_la_madre.datos_basicos.segundo_apellido", datos["segundoApellido"])
  	form_data.set("datos_de_la_madre.datos_basicos.apellido_de_casada", datos["apellidoCasada"])
  else
  	transition_errors << "Los datos de la madre no fueron encontrados, por favor verifique.\n"
  end

views: 
back_step: ""
next_step: Paso 2 - Datos Familiares
position: 1
ajax_calls: ""
