--- 
id: 2959
name: Paso 2 - Datos del Autores o Titulares
label: Datos del Autor (es) o Titular (es)
description: ""
fill_step_id: 1589
created_at: 2014-10-09 21:51:34 Z
updated_at: 2014-12-05 18:53:54 Z
include: "{\"4604\":{\"3149\":{\"3605\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"3151\":{\"1981\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"528\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"529\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"530\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"537\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"926\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"545\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"546\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"2983\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"763\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"3152\":{\"2979\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"2980\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"3154\":{\"567\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1282\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"3342\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"3153\":{\"572\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"805\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"585\":{\"views\":\"default\",\"enabled\":\"enabled\"}}}}"
allowed_next_to_steps: ""
allowed_back_to_steps: ""
controls: ,back,next,close,close_and_save,save
on_becoming: "   "
on_transition: "(1..6).each do |_num|\r\n\
  tipo_doc = form_data.get(\"tipo_de_documento_mici_instance_#{_num}.tipo_documento_mici.tipo_de_documento\")\r\n\
  if (tipo_doc = \"Pasaporte\" ||tipo_doc = \"C\xC3\xA9dula\")\r\n\
  \r\n #::::::::::::: Concatenar Nombre para el Print Designer :::::::::::::::::::::#\r\n\
  \t     nombre2 = form_data.get(\"datos_de_autores_instance_#{_num}.datos_de_la_persona.primer_nombre\")\r\n\
  \t\t nombre3 = form_data.get(\"datos_de_autores_instance_#{_num}.datos_de_la_persona.segundo_nombre\")\r\n\
  \t\t nombre4 = form_data.get(\"datos_de_autores_instance_#{_num}.datos_de_la_persona.primer_apellido\")\r\n\
  \t\t nombre5 = form_data.get(\"datos_de_autores_instance_#{_num}.datos_de_la_persona.segundo_apellido\")\r\n\
  \t\t nombre6 = form_data.get(\"datos_de_autores_instance_#{_num}.datos_de_la_persona.apellido_de_casada\")\r\n\
  \t\t nombre_completo = \"#{nombre2} #{nombre3} #{nombre4} #{nombre5} #{nombre6}\"\r\n\
  \t\t form_data.set(\"datos_de_autores_instance_#{_num}.datos_de_la_persona.nombre_completo\", nombre_completo) \r\n\
  end\r\n\
  #::: VALIDACION DE FECHA DE NACIMIENTO :::#\r\n\
  \t\t \r\n\
  \t_defuncion = form_data.get(\"datos_de_autores_instance_#{_num}.datos_de_la_persona.fecha_de_defuncion\")\r\n\
  \tfecha_nac = form_data.get(\"datos_de_autores_instance_#{_num}.datos_de_la_persona.fecha_de_nacimiento\")\t\r\n\
  \tform_data.set(\"datos_de_autores_instance_#{_num}.datos_de_la_persona.edad\",\"\")\r\n\
  \tif (fecha_nac.to_date > Date.today)\t\t\r\n\
  \t\ttransition_errors << \"La fecha de nacimiento del Autor #{_num} no puede ser mayor a la fecha actual. Por favor, verifique.\"\r\n\
  \tend\r\n\
  \r\n\
  #::: CALCULAR LA EDAD :::#\r\n\
  if (tipo_doc == \"Pasaporte\")\r\n\
  \r\n\
  \tfechan = form_data.get(\"datos_de_autores_instance_#{_num}.datos_de_la_persona.fecha_de_nacimiento\")\r\n\
  \tedad = ((Date.today - fechan.to_date).to_f / 365).to_i\r\n\
  \tif (edad.to_i < 18.to_i)  \r\n\
  \t\ttransition_errors << \"La edad del Autor #{_num} no debe ser menor a 18 a\xC3\xB1os de edad. Por favor, verifique\"\r\n\
  \telse\r\n\
  \t\tform_data.set(\"datos_de_autores_instance_#{_num}.datos_de_la_persona.edad\",edad)\r\n\
  \tend\r\n\
  end\r\n\
  \r\n\
  \t#::: VALIDACION DE FECHA DE DEFUNCION :::#\r\n\
  \tif (_defuncion.to_date > Date.today)\r\n\
  \t\ttransition_errors << \"La fecha de defuncion del Autor #{_num} no puede ser mayor a la fecha actual. Por favor, verifique.\"\r\n\
  \tend\r\n\
  end"
views: 
back_step: Paso 1 - Datos del Autor y Titular
next_step: Paso 3 - Datos a modificar de la obra
position: 2
ajax_calls: "$(document).ready(function(){\r\n    $.each( $('[id*=datos_de_autores_]'), function(index, campo) {   \r\n        var pos = (this.id).match(/_instance_[\\d][\\d]/);\r\n        if (pos == null){\r\n          pos = (this.id).match(/_instance_[\\d]/);\r\n        }\r\n        var InicioRuta = \"#field_datos_de_autores\";\r\n        var TipoDoc = \"_tipo_de_identificacion_tipo_identificacion_texto\";\r\n        var NroDoc = \"_datos_de_la_persona_cedula_pasaporte\";\r\n        var NroRuc = \"_datos_de_la_empresa_ruc\";\r\n        var Seudonimo = \"_seudonimo_indique_seudonimo\"\r\n         var coincide = InicioRuta.concat(pos);\r\n        var TipoDocu = coincide.concat(TipoDoc);\r\n        var ced = coincide.concat(NroDoc);\r\n        var ruc =  coincide.concat(NroRuc);\r\n        var seu = coincide.concat(Seudonimo);\r\n       \r\n\
  //#::::::::::::: Datos a deshabilitar en persona natural ::::::::::::::::://\r\n\
  \r\n        var doc = \"_datos_de_la_persona_cedula_pasaporte\";\r\n        var nom = \"_datos_de_la_persona_primer_nombre\";\r\n        var nom2 = \"_datos_de_la_persona_segundo_nombre\";\r\n        var nom3 = \"_datos_de_la_persona_primer_apellido\";\r\n        var nom4 = \"_datos_de_la_persona_segundo_apellido\";\r\n        var fec = \"_datos_de_la_persona_fecha_de_nacimiento\";\r\n        var nac = \"_datos_de_la_persona_nacionalidad\";\r\n        var edad = \"_datos_de_la_persona_edad\";\r\n        var dir = \"_informacion_de_residencia_localizacion_direccion\";\r\n        var tlf = \"_informacion_de_residencia_localizacion_numero_de_telefono\";\r\n        var email = \"_informacion_de_residencia_localizacion_correo_electronico\";\r\n        var documento = coincide.concat(doc);\r\n        var nombre1 =  coincide.concat(nom);\r\n        var nombre2 =  coincide.concat(nom2);\r\n        var nombre3 =  coincide.concat(nom3);\r\n        var nombre4 = coincide.concat(nom4);\r\n        var fecha = coincide.concat(fec);\r\n        var nacionalidad = coincide.concat(nac);\r\n        var telefono = coincide.concat(tlf);\r\n        var correo = coincide.concat(email);\r\n        var edad1 = coincide.concat(edad);\r\n        var direccion = coincide.concat(dir);\r\n        if($(TipoDocu).val() == 'C\xC3\xA9dula' || $(TipoDocu).val() == 'Pasaporte'){\r\n            $(ruc).parents(\".part-box\").hide();\r\n        }else {\r\n\
  \r\n            $(ced).parents(\".part-box\").hide();\r\n            $(seu).parents(\".part-box\").hide();\r\n            //$(telefono).parents(\".field-box\").hide();\r\n            $(correo).parents(\".field-box\").hide();\r\n        }\r\n        if($(TipoDocu).val() == 'C\xC3\xA9dula'){           \r\n           \r\n            $(nombre1).attr(\"disabled\",\"disabled\");\r\n            $(nombre2).attr(\"disabled\",\"disabled\");\r\n            $(nombre3).attr(\"disabled\",\"disabled\");\r\n            $(nombre4).attr(\"disabled\",\"disabled\");\r\n            $(fecha).attr(\"disabled\",\"disabled\");\r\n            $(edad1).attr(\"disabled\",\"disabled\");\r\n            $(nacionalidad).attr(\"disabled\",\"disabled\");           \r\n        }\r\n\
  \r\n        if($(TipoDocu).val() == 'Pasaporte' && $(telefono).val() ==''){   \r\n           \r\n            $(nombre1).val('');\r\n            $(nombre2).val('');\r\n            $(nombre3).val('');\r\n            $(nombre4).val('');\r\n            //$(fecha).val('');\r\n            $(edad1).val('');\r\n            $(nacionalidad).val('');\r\n            $(direccion).val('');           \r\n        }   \r\n\
  \r\n        if($(TipoDocu).val() == ''){\r\n            $(ced).parents(\".section-box\").hide();\r\n        }   \r\n        $(TipoDocu).parents(\".section-box\").next().hide();\r\n\
  \r\n\
  //::::::::::::::::::::::: VALIDACION SEUDONIMO:::::::::::::::::::://\r\n              \r\n        var inicio = \"input[name='[field][datos_de_autores\";\r\n        var fin = \"_seudonimo_seudonimo][]']\";\r\n        var medio = inicio.concat(pos);\r\n        var palabra = medio.concat(fin);\r\n        var detal = \"_seudonimo_indique_seudonimo\";\r\n        var detalle = coincide.concat(detal);\r\n\
  \r\n        $(palabra).click(function(event){\r\n            $(this).each(function(){\r\n                if (this.checked) {\r\n                    var dato1 = $(this).val();\r\n                    if(dato1 == 'Seudonimo'){\r\n                        $(detalle).removeAttr(\"disabled\");\r\n                    }\r\n                }\r\n                if (!this.checked) {\r\n                    var dato1 = $(this).val();\r\n                    if(dato1 == 'Seudonimo'){\r\n                        $(detalle).val('');\r\n                        $(detalle).attr(\"disabled\",\"disabled\");\r\n                    }\r\n                }\r\n            });\r\n        });   \r\n    });\r\n\
  });\r\n\
  \r\n\
  //::::::::::::::::Calcular Edad:::::::::::::::::::::::::::::://\r\n\
  $(document).ready(function(){\r\n\
  $.each( $('[id*=datos_de_autores_]'), function(index, campo) {\r\n\
  var pos = (this.id).match(/_instance_[\\d][\\d]/);\r\n\
  if (pos == null){\r\n\
  pos = (this.id).match(/_instance_[\\d]/);\r\n\
  }\r\n\
  var iniciorut = \"#field_datos_de_autores\";\r\n\
  var fecha = \"_datos_de_la_persona_fecha_de_nacimiento\";\r\n\
  var edad = \"_datos_de_la_persona_edad\";\r\n\
  var coincide = iniciorut.concat(pos);\r\n\
  var Fnac = coincide.concat(fecha);\r\n\
  var Edad1 = coincide.concat(edad);\r\n\
  \r\n\
  $(Fnac).change(function(){\r\n\
  var fecha1 = $(Fnac).val();\r\n\
  var values = fecha1.split(\"-\");\r\n\
  var dia = values[0];\r\n\
  var mes = values[1];\r\n\
  var ano = values[2];\r\n\
  \r\n\
  //::: OBTENER LOS VALORES ACTUALES ::://\r\n\
  var fecha_hoy = new Date();\r\n\
  var ahora_ano = fecha_hoy.getYear();\r\n\
  var ahora_mes = fecha_hoy.getMonth();\r\n\
  var ahora_dia = fecha_hoy.getDate();\r\n\
  //::: REALIZAR EL CALCULO ::://\r\n\
  var edad2 = (ahora_ano + 1900) - ano;\r\n\
  if ( ahora_mes < (mes - 1)){\r\n\
  edad2--;\r\n\
  }\r\n\
  if (((mes - 1) == ahora_mes) && (ahora_dia < dia)){\r\n\
  edad2--;\r\n\
  }\r\n\
  if (((mes) == ahora_mes) && (ahora_dia < dia)){\r\n\
  edad2--;\r\n\
  }\r\n\
  if (edad2 > 1900){\r\n\
  edad2 -= 1900;\r\n\
  }\r\n\
  $(Edad1).val(edad2);\r\n\
  });\r\n\
  });\r\n\
  });\r\n"
