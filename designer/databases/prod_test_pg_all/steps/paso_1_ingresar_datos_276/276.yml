--- 
id: 276
name: Paso 1 - Ingresar Datos
label: " Ingresar Datos"
description: Ingrese los datos correspondientes.
fill_step_id: 160
created_at: 2012-05-03 19:40:25 Z
updated_at: 2015-10-19 02:11:52 Z
include: "{\"880\":{\"586\":{\"608\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"882\":{\"580\":{\"1323\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"883\":{\"580\":{\"1323\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"892\":{\"1710\":{\"1401\":{\"views\":\"only_view\",\"enabled\":\"disabled\"},\"1402\":{\"views\":\"only_view\",\"enabled\":\"disabled\"}}}}"
allowed_next_to_steps: ""
allowed_back_to_steps: ""
controls: ,next,close,close_and_save,save
on_becoming: "person = @application[\"person_id\"]\r\n\
  owner = @application[\"owner_person_id\"]\r\n\
  \r\n\
  if person != owner\r\n    if @owner[\"natural_person_type\"]==\"national_citizen\"\r\n        _tipo = \"C\xC3\xA9dula\"\r\n        _ci = @owner[\"national_id\"]\r\n        result = WebserviceConsumer.get('/service/bdin_tribunal_electoral/find.json?cedula=' + \"#{_ci}\").parsed_response\r\n        datos = result[\"response\"]\r\n        if !datos.nil?\r\n            form_data.set(\"datos_del_asegurado.representado_por.cedula_pasaporte\",datos[\"cedula\"])\r\n            form_data.set(\"datos_del_asegurado.representado_por.nombre_completo\",datos[\"primerNombre\"]+\" \"+datos[\"segundoNombre\"]+\" \"+datos[\"primerApellido\"]+\" \"+datos[\"segundoApellido\"])\r\n            form_data.set(\"datos_del_asegurado.representado_por.numero_de_telefono\", datos[\"tlfLocal\"])\r\n            form_data.set(\"datos_del_asegurado.representado_por.email\", datos[\"email\"])\r\n            if @owner[\"gender\"]==\"male\"\r\n                _sexo = \"Masculino\"\r\n            else\r\n                _sexo= \"Femenino\"\r\n            end\r\n            form_data.set(\"datos_del_asegurado.representado_por.sexo_string\", _sexo)\r\n        end     \r\n\
  \r\n    else\r\n        if ((@owner[\"kind_of_user_type\"] == \"NaturalPerson\") && (@owner[\"natural_person_type\"] == \"foreign_citizen\"))\r\n            form_data.set(\"datos_del_asegurado.representado_por.cedula_pasaporte\", @owner[\"passport\"])\r\n            form_data.set(\"datos_del_asegurado.representado_por.nombre_completo\", @owner[\"first_name\"]+\" \"+@owner[\"second_name\"]+\" \"+@owner[\"last_name\"]+\" \"+@owner[\"second_last_name\"])\r\n            form_data.set(\"datos_del_asegurado.representado_por.numero_de_telefono\", @owner[\"fixed_number\"])\r\n            form_data.set(\"datos_del_asegurado.representado_por.email\", @owner[\"email\"])\r\n            if @owner[\"gender\"]==\"male\"\r\n                _sexo = \"Masculino\"\r\n            else\r\n                _sexo= \"Femenino\"\r\n            end\r\n            form_data.set(\"datos_del_asegurado.representado_por.sexo_string\", _sexo)\r\n        end\r\n    end\r\n\
  \r\n    ###Se setean datos del solicitante###\r\n\
  \r\n\
  \r\n\
  end\r\n\
  \r\n\
  \r\n\
  if person == owner\r\n    _idpersona = @application[\"person_id\"].to_s\r\n    result = WebserviceConsumer.get( '/preconfigured_services/get_user_info.xml?person_id=' + \"#{_idpersona}\" + '&include_all=true').parsed_response\r\n    _hash = result[\"hash\"]\r\n    persona = _hash[\"response\"]\r\n    form_data.set(\"datos_del_solicitante.datos_persona_natural.cedula\",persona[\"person_gov_id_number\"])\r\n    form_data.set(\"datos_del_solicitante.datos_persona_natural.nombre_completo\",persona[\"name\"])\r\n    form_data.set(\"datos_del_solicitante.datos_persona_natural.email\",persona[\"email\"])\r\n    #form_data.set(\"datos_del_solicitante.datos_persona_natural.numero_de_telefono\",persona[\"fixed_number\"])\r\n\
  end "
on_transition: "numSS = form_data.get(\"datos_del_asegurado.informacion_laboral.numero_de_seguro_social\")\r\n\
  result = WebserviceConsumer.get( '/service/bdin_caja_seguro_social_obtener_datosdel_asegurado/find.json?nroSeguro=' + \"#{numSS}\").parsed_response\r\n\
  data = result[\"response\"]\r\n\
  if !data.blank?\r\n   ci = form_data.set(\"datos_del_asegurado.datos_de_la_persona.cedula_pasaporte\",data[\"cedula\"])\r\n   result = WebserviceConsumer.get('/service/bdin_tribunal_electoral/find.json?cedula=' + \"#{ci}\").parsed_response\r\n   datos = result[\"response\"]\r\n   if !datos.blank?\r\n      difunto = datos[\"mensaje\"]\r\n        if (difunto != \"ND\")\r\n            transition_errors << \"No puede continuar con el tr\xC3\xA1mite, ya que la c\xC3\xA9dula nro. #{ci} del Asegurado corresponde a un ciudadano Difunto.\"\r\n        end\r\n      form_data.set(\"datos_del_asegurado.datos_de_la_persona.cedula_pasaporte\",datos[\"cedula\"])\r\n      form_data.set(\"datos_del_asegurado.datos_de_la_persona.primer_nombre\",data[\"primerNombre\"])\r\n      form_data.set(\"datos_del_asegurado.datos_de_la_persona.segundo_nombre\",data[\"segundoNombre\"])\r\n      form_data.set(\"datos_del_asegurado.datos_de_la_persona.primer_apellido\",data[\"primerApellido\"])\r\n      form_data.set(\"datos_del_asegurado.datos_de_la_persona.segundo_apellido\",data[\"segundoApellido\"])\r\n      form_data.set(\"datos_del_asegurado.datos_de_la_persona.apellido_de_casada\",data[\"apellidoCasada\"])\r\n      form_data.set(\"datos_del_asegurado.datos_de_la_persona.fecha_de_nacimiento_string\",data[\"fechaNacimiento\"])\r\n      form_data.set(\"datos_del_asegurado.datos_de_la_persona.sexo_string\",data[\"sexo\"])\r\n      form_data.set(\"datos_del_asegurado.datos_de_la_persona.estado_civil_string\",data[\"estadoCivil\"])\r\n      form_data.set(\"datos_del_asegurado.informacion_laboral.numero_de_seguro_social\",data[\"nroSeguro\"])\r\n      form_data.set(\"datos_del_asegurado.datos_de_la_persona.telefono_de_oficina\",data[\"fax\"])\r\n      form_data.set(\"datos_del_asegurado.datos_de_la_persona.telefono_auxiliar\",data[\"tlfLocal\"])\r\n      form_data.set(\"datos_del_asegurado.datos_de_la_persona.numero_celular\",data[\"tlfCelular\"])\r\n      form_data.set(\"datos_del_asegurado.datos_de_la_persona.email\",data[\"email\"])\r\n      form_data.set(\"lugar_de_nacimiento.lugar_de_nacimiento.provincia\",data[\"provincia\"])\r\n      form_data.set(\"lugar_de_nacimiento.lugar_de_nacimiento.distrito\",data[\"distrito\"])\r\n      form_data.set(\"lugar_de_nacimiento.lugar_de_nacimiento.corregimiento\",data[\"corregimiento\"])\r\n   else\r\n      transition_errors << \"El n\xC3\xBAmero de C\xC3\xA9dula del asegurado no fue encontrado en el sistema, por favor verifique.\"\r\n   end\r\n\
  \r\n   ciPadre = form_data.get(\"datos_del_padre.datos_de_la_persona.cedula\")\r\n   result = WebserviceConsumer.get('/service/bdin_tribunal_electoral/find.json?cedula=' + \"#{ciPadre}\").parsed_response\r\n   datoscip = result[\"response\"]\r\n   if !datoscip.blank?  \r\n    difuntoP = datoscip[\"mensaje\"]\r\n        if (difuntoP != \"ND\")\r\n            transition_errors << \"No puede continuar con el tr\xC3\xA1mite, ya que la c\xC3\xA9dula nro. #{ciPadre} del Padre corresponde a un ciudadano Difunto.\"\r\n        end\r\n      form_data.set(\"datos_del_padre.datos_de_la_persona.cedula\",datoscip[\"cedula\"])\r\n      form_data.set(\"datos_del_padre.datos_de_la_persona.primer_nombre\",datoscip[\"primerNombre\"])\r\n      form_data.set(\"datos_del_padre.datos_de_la_persona.segundo_nombre\",datoscip[\"segundoNombre\"])\r\n      form_data.set(\"datos_del_padre.datos_de_la_persona.primer_apellido\",datoscip[\"primerApellido\"])\r\n      form_data.set(\"datos_del_padre.datos_de_la_persona.segundo_apellido\",datoscip[\"segundoApellido\"])\r\n   else\r\n      transition_errors << \"El n\xC3\xBAmero de C\xC3\xA9dula del padre no fue encontrado, por favor verifique.\"\r\n   end  \r\n\
  \r\n   ciMadre = form_data.get(\"datos_de_la_madre.datos_de_la_persona.cedula\")\r\n   result = WebserviceConsumer.get('/service/bdin_tribunal_electoral/find.json?cedula=' + \"#{ciMadre}\").parsed_response\r\n   datoscim = result[\"response\"]\r\n   if !datoscim.blank?\r\n      difuntoM = datoscim[\"mensaje\"]\r\n        if (difuntoM != \"ND\")\r\n            transition_errors << \"No puede continuar con el tr\xC3\xA1mite, ya que la c\xC3\xA9dula nro. #{ciMadre} de la madre corresponde a un ciudadano Difunto.\"\r\n        end\r\n      form_data.set(\"datos_de_la_madre.datos_de_la_persona.cedula\",datoscim[\"cedula\"])\r\n      form_data.set(\"datos_de_la_madre.datos_de_la_persona.primer_nombre\",datoscim[\"primerNombre\"])\r\n      form_data.set(\"datos_de_la_madre.datos_de_la_persona.segundo_nombre\",datoscim[\"segundoNombre\"])\r\n      form_data.set(\"datos_de_la_madre.datos_de_la_persona.primer_apellido\",datoscim[\"primerApellido\"])\r\n      form_data.set(\"datos_de_la_madre.datos_de_la_persona.segundo_apellido\",datoscim[\"segundoApellido\"])\r\n   else\r\n      transition_errors << \"El n\xC3\xBAmero de C\xC3\xA9dula de la madre no fue encontrado, por favor verifique.\"\r\n   end\r\n\
  else\r\n   transition_errors << \"El n\xC3\xBAmero de Seguro Social del asegurado no fue encontrado, por favor verifique.\"\r\n\
  end"
views: 
back_step: ""
next_step: Paso 2- Datos del Asegurado
position: 1
ajax_calls: ""
