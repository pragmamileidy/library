--- 
id: 3118
name: Paso 3 - Datos del Proyecto
label: "N\xC3\xBAmero de Plano Asignado"
description: Por favor, verifique los datos del Plano asignado y el uso de suelo.
fill_step_id: 1666
created_at: 2015-04-07 13:23:29 Z
updated_at: 2015-05-05 22:41:07 Z
include: "{\"4795\":{\"2197\":{\"2395\":{\"views\":\"default\",\"enabled\":\"disabled\"}}},\"4797\":{\"2380\":{\"3194\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"3451\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"4816\":{\"2781\":{\"3189\":{\"views\":\"default\",\"enabled\":\"disabled\"}}}}"
allowed_next_to_steps: ""
allowed_back_to_steps: ""
controls: ,back,next,close,close_and_save,save
on_becoming: "#ON BECOMING PASO 4\r\n\
  \r\n\
  _numero_de_plano = form_data.get( \"datos_generales_del_proyecto.datos_generales_del_proyecto.numero_de_plano\")\r\n\
  if  _numero_de_plano.blank?\r\n\
  \tresult = WebserviceConsumer.get('/service/ws_tipo_de_plano/records.json').parsed_response\r\n\
  \r\n\
  \t_secuencia=\"\"\r\n\
  \t_tipoPlano=\"\"\r\n\
  \tplanos = form_data.get(\"datos_generales_de_la_solicitud.datos_generales_de_la_solicitud.tipo_de_plano\")\r\n\
  \tplano = WebserviceConsumer.get(URI.escape('/service/ws_tipo_de_plano/find.json?nombre=' + planos)).parsed_response\r\n\
  \t_siglas = plano[\"response\"][\"siglas\"]\r\n\
  \r\n\
  \tif _siglas==(result[\"response\"][0][\"siglas\"])\r\n\
  \t _tipoPlano= result[\"response\"][0][\"siglas\"]\r\n\
  \tend\r\n\
  \r\n\
  \tif _siglas==(result[\"response\"][1][\"siglas\"])\r\n\
  \t _tipoPlano= result[\"response\"][1][\"siglas\"]\r\n\
  \tend\r\n\
  \r\n\
  \tif _siglas==(result[\"response\"][2][\"siglas\"])\r\n\
  \t _tipoPlano= result[\"response\"][2][\"siglas\"]\r\n\
  \tend\r\n\
  \r\n\
  \r\n\
  \r\n\
  \t####Categoria de Proyecto\r\n\
  \r\n\
  \tresult = WebserviceConsumer.get('/service/ws_categoria_de_proyecto/records.json').parsed_response\r\n\
  \t_cat=\"\"\r\n\
  \tcategorias = form_data.get(\"datos_generales_del_proyecto.datos_generales_del_proyecto.categoria_del_proyecto\")\r\n\
  \tcategoria = WebserviceConsumer.get(URI.escape('/service/ws_categoria_de_proyecto/find.json?nombre=' + categorias)).parsed_response\r\n\
  \t_siglasc = categoria[\"response\"][\"siglas\"]\r\n\
  \r\n\
  \tif _siglasc==(result[\"response\"][0][\"siglas\"])\r\n\
  \t _cat= result[\"response\"][0][\"siglas\"]\r\n\
  \tend\r\n\
  \r\n\
  \tif _siglasc==(result[\"response\"][1][\"siglas\"])\r\n\
  \t _cat= result[\"response\"][1][\"siglas\"]\r\n\
  \tend\r\n\
  \r\n\
  \tif _siglasc==(result[\"response\"][2][\"siglas\"])\r\n\
  \t _cat= result[\"response\"][2][\"siglas\"]\r\n\
  \tend\r\n\
  \r\n\
  \tif _siglasc==(result[\"response\"][3][\"siglas\"])\r\n\
  \t _cat= result[\"response\"][3][\"siglas\"]\r\n\
  \tend\r\n\
  \r\n\
  \tif _siglasc==(result[\"response\"][4][\"siglas\"])\r\n\
  \t _cat= result[\"response\"][4][\"siglas\"]\r\n\
  \tend\r\n\
  \r\n\
  \t#Secuencia num\xC3\xA9rica:\r\n\
  \t\r\n\
  \tresult = WebserviceConsumer.get('/consecutive/generador_numero_de_plano/generate.json').parsed_response\r\n\
  \t_po = result[\"response\"][\"value\"]\r\n\
  \t#Dos \xC3\xBAltimos d\xC3\xADgitos del a\xC3\xB1o en curso\r\n\
  \t_time = Time.new\r\n\
  \t_ano = _time.year.to_s[-2,2]\r\n\
  \t_numero = \"#{_tipoPlano}\"+'-'+\"#{_cat}\"+'-'+\"#{_po}\"+'-'+\"#{_ano}\"\r\n\
  \tform_data.set(\"datos_generales_del_proyecto.datos_generales_del_proyecto.numero_de_plano\",_numero)\r\n\
  end\r\n\
  \r\n\
  \r\n\
  \r\n\
  ####Validaci\xC3\xB3n para colocar pago manual por defecto\r\n\
  form_data.set(\"forma_de_pago.forma_de_pago.indique_la_forma_de_pago\", \"Pago Manual\")\r\n"
on_transition: ""
views: 
back_step: Paso 2 - Datos de la Finca
next_step: Paso 4 - Archivos Adjuntos
position: 3
ajax_calls: "\t\t\r\n\
  \t///ocultar o mostrar campo otro dependiendo de la selecci\xC3\xB3n\t\r\n\
  \t\t$(document).ready(function(){\r\n\
  \t\t\t$(\"#field_uso_del_suelo_uso_del_suelo_otro\").parent().parent().hide();\r\n\
  \t\t\t$(\"#field_uso_del_suelo_uso_del_suelo_tipo_de_suelo\").change(function(){\r\n\
  \t\t\tdato= $(\"#field_uso_del_suelo_uso_del_suelo_tipo_de_suelo\").find(':selected').val();\r\n\
  \t\t\t\tif(dato == ' Otro'){\r\n\
  \t\t\t\t\t$(\"#field_uso_del_suelo_uso_del_suelo_otro\").val('');\r\n\
  \t\t\t\t\t$(\"#field_uso_del_suelo_uso_del_suelo_otro\").parent().parent().show();\r\n\
  \t\t\t\t}\r\n\
  \t\t\t\telse{\r\n\
  \t\t\t\t\t$(\"#field_uso_del_suelo_uso_del_suelo_otro\").val('');\r\n\
  \t\t\t\t\t$(\"#field_uso_del_suelo_uso_del_suelo_otro\").parent().parent().hide();\r\n\
  \t\t\t\t}\r\n\
  \t\t\t});\r\n\
  \t\t\tdato= $(\"#field_uso_del_suelo_uso_del_suelo_tipo_de_suelo\").find(':selected').val();\r\n\
  \t\t\tif(dato == ' Otro'){\r\n\
  \t\t\t\t\t$(\"#field_uso_del_suelo_uso_del_suelo_otro\").parent().parent().show();\r\n\
  \t\t\t\t}\r\n\
  \t\t\t\telse{\r\n\
  \t\t\t\t$(\"#field_uso_del_suelo_uso_del_suelo_otro\").val('');\r\n\
  \t\t\t\t$(\"#field_uso_del_suelo_uso_del_suelo_otro\").parent().parent().hide();\r\n\
  \t\t\t\t}\r\n\
  \t  });"
