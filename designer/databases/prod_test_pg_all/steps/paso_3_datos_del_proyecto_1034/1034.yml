--- 
id: 1034
name: Paso 3 - Datos del Proyecto
label: "N\xC3\xBAmero de Plano Asignado"
description: "N\xC3\xBAmero de Plano Asignado"
fill_step_id: 534
created_at: 2013-01-23 14:34:41 Z
updated_at: 2013-03-16 17:29:09 Z
include: "{\"2336\":{\"2197\":{\"2395\":{\"views\":\"default\",\"enabled\":\"disabled\"}}}}"
allowed_next_to_steps: ""
allowed_back_to_steps: ""
controls: ,back,next,close,close_and_save,save
on_becoming: "result = WebserviceConsumer.get('/service/ws_tipo_de_plano/records.json').parsed_response\r\n\
  \r\n\
  _secuencia=\"\"\r\n\
  _tipoPlano=\"\"\r\n\
  planos = form_data.get(\"datos_generales_de_la_solicitud.datos_generales_de_la_solicitud.tipo_de_plano\")\r\n\
  plano = WebserviceConsumer.get(URI.escape('/service/ws_tipo_de_plano/find.json?nombre=' + planos)).parsed_response\r\n\
  _siglas = plano[\"response\"][\"siglas\"]\r\n\
  \r\n\
  if _siglas==(result[\"response\"][0][\"siglas\"])\r\n _tipoPlano= result[\"response\"][0][\"siglas\"]\r\n _secuencia=\"generador_municipio_plano_po\"\r\n\
  end\r\n\
  \r\n\
  if _siglas==(result[\"response\"][1][\"siglas\"])\r\n _tipoPlano= result[\"response\"][1][\"siglas\"]\r\n _secuencia=\"generador_municipio_plano_po\"\r\n\
  end\r\n\
  \r\n\
  if _siglas==(result[\"response\"][2][\"siglas\"])\r\n _tipoPlano= result[\"response\"][2][\"siglas\"]\r\n _secuencia=\"generador_municipio_plano_plue\"\r\n\
  end\r\n\
  \r\n\
  if _siglas==(result[\"response\"][3][\"siglas\"])\r\n _tipoPlano= result[\"response\"][3][\"siglas\"]\r\n _secuencia=\"generador_municipio_plano_pmtt\"\r\n\
  end\r\n\
  \r\n\
  if _siglas==(result[\"response\"][4][\"siglas\"])\r\n _tipoPlano= result[\"response\"][4][\"siglas\"]\r\n _secuencia=\"generador_municipio_plano_pe\"\r\n\
  end\r\n\
  \r\n\
  if _siglas==(result[\"response\"][5][\"siglas\"])\r\n _tipoPlano= result[\"response\"][5][\"siglas\"]\r\n _secuencia=\"generador_municipio_plano_pm\"\r\n\
  end\r\n\
  \r\n\
  \r\n\
  \r\n\
  ####Categoria de Proyecto\r\n\
  \r\n\
  result = WebserviceConsumer.get('/service/ws_categoria_de_proyecto/records.json').parsed_response\r\n\
  _cat=\"\"\r\n\
  categorias = form_data.get(\"datos_generales_del_proyecto.datos_generales_del_proyecto.categoria_del_proyecto\")\r\n\
  categoria = WebserviceConsumer.get(URI.escape('/service/ws_categoria_de_proyecto/find.json?nombre=' + categorias)).parsed_response\r\n\
  _siglasc = categoria[\"response\"][\"siglas\"]\r\n\
  \r\n\
  if _siglasc==(result[\"response\"][0][\"siglas\"])\r\n _cat= result[\"response\"][0][\"siglas\"]\r\n\
  end\r\n\
  \r\n\
  if _siglasc==(result[\"response\"][1][\"siglas\"])\r\n _cat= result[\"response\"][1][\"siglas\"]\r\n\
  end\r\n\
  \r\n\
  if _siglasc==(result[\"response\"][2][\"siglas\"])\r\n _cat= result[\"response\"][2][\"siglas\"]\r\n\
  end\r\n\
  \r\n\
  if _siglasc==(result[\"response\"][3][\"siglas\"])\r\n _cat= result[\"response\"][3][\"siglas\"]\r\n\
  end\r\n\
  \r\n\
  if _siglasc==(result[\"response\"][4][\"siglas\"])\r\n _cat= result[\"response\"][4][\"siglas\"]\r\n\
  end\r\n\
  \r\n\
  #Secuencia num\xC3\xA9rica:\r\n\
  result = WebserviceConsumer.get('/consecutive/'+\"#{_secuencia}\"+'/generate.json').parsed_response\r\n\
  _po = result[\"response\"][\"value\"]\r\n\
  #Dos \xC3\xBAltimos d\xC3\xADgitos del a\xC3\xB1o en curso\r\n\
  _time = Time.new\r\n\
  _ano = _time.year.to_s[-2,2]\r\n\
  _numero = \"#{_tipoPlano}\"+'-'+\"#{_cat}\"+'-'+\"#{_po}\"+'-'+\"#{_ano}\"\r\n\
  form_data.set(\"datos_generales_del_proyecto.datos_generales_del_proyecto.numero_de_plano\",_numero)"
on_transition: ""
views: 
back_step: Paso 2 - Datos de la Finca
next_step: Paso 4 - Archivos Adjuntos
position: 3
ajax_calls: ""
