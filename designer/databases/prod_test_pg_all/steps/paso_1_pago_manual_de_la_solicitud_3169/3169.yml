--- 
id: 3169
name: Paso 1- Pago Manual de la Solicitud
label: Pago Manual de la Solicitud
description: ""
fill_step_id: 1695
created_at: 2015-08-04 20:09:01 Z
updated_at: 2016-07-07 12:53:08.702751 Z
include: "{\"4882\":{\"2839\":{\"3101\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2849\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2840\":{\"3101\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2849\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2841\":{\"3101\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2849\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2842\":{\"3101\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2849\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2843\":{\"3101\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2849\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2844\":{\"3101\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2849\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2845\":{\"3101\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2849\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2846\":{\"3101\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2849\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2847\":{\"3101\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2849\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2848\":{\"3101\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2849\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2849\":{\"3101\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2849\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2850\":{\"3101\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2849\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2851\":{\"3101\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2849\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2852\":{\"3101\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2849\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2853\":{\"3101\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2849\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2854\":{\"2892\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"4883\":{\"2054\":{\"2164\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2165\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"3447\":{\"views\":\"default\",\"enabled\":\"enabled\"}}}}"
allowed_next_to_steps: ""
allowed_back_to_steps: ""
controls: ,next,close,close_and_save,save
on_becoming: "#CODIGO PARA INVOCAR EL SERVICIO payment_computing_service\r\n\
  _applicationId = @application[\"id\"]\r\n\
  _configRoute = \"Rates-rates\"\r\n\
  _formId = @task[\"form\"]\r\n\
  _taskId = @task[\"id\"]\r\n\
  \r\n\
  # ***** Servicio nuevo *****\r\n\
  hash = {:application_id => \"#{_applicationId}\",\r\n\
  :config_route => \"#{_configRoute}\",\r\n\
  :form_id => \"#{_formId}\",\r\n\
  :task_id => \"#{_taskId}\"}\r\n\
  result = PaymentProxy.manual_computing_service(hash)\r\n\
  _payment_id= result[\"response\"][\"payment_id\"]\r\n\
  _detail = result[\"response\"][\"detail\"]\r\n\
  _total = result[\"response\"][\"result\"][\"total\"]\r\n\
  form_data.set(\"variables_pago_generico.variables_pago_generico.payment\",_payment_id)\r\n\
  form_data.set(\"variables_pago_generico.variables_pago_generico.detail\",_detail)\r\n\
  form_data.set(\"datos_del_evaluador_generico.monto_total.monto_total\", _total)\r\n\
  result[\"response\"][\"result\"][\"items\"].each do |key, value|\r\n\
  if(key =~ /item_instance_([\\d]+)/)\r\n\
  _i = $1.to_i - 1\r\n\
  form_data.set(\"datos_del_evaluador_generico.entidad_evaluadora_#{_i}.nombre_de_la_entidad\", value[\"name\"])\r\n\
  form_data.set(\"datos_del_evaluador_generico.entidad_evaluadora_#{_i}.pagada\", \"Iniciada\")\r\n\
  form_data.set(\"datos_del_evaluador_generico.entidad_evaluadora_#{_i}.monto_a_pagar\", value[\"formula\"])\r\n\
  end\r\n\
  end"
on_transition: ""
views: 
back_step: ""
next_step: Paso 2- Ingresar pago de la solicitud
position: 1
ajax_calls: |-
  $( function() {
  	$(document).ready(function(){
  		function partContainer(obj) {
  			return obj.parent().parent().parent().parent().parent().children();
  			};
  			function valueIsCero(obj) {
  				return ((obj.val() == "") || (obj.val() == 0));
  				};
  				function hideIfCero(obj) {
  					if( valueIsCero(obj) ){ partContainer(obj).hide(); partContainer(obj).parent().hide(); };
  						};
  						hideIfCero($('#field_datos_del_evaluador_generico_entidad_evaluadora_0_monto_a_pagar'));
  						hideIfCero($('#field_datos_del_evaluador_generico_entidad_evaluadora_1_monto_a_pagar'));
  						hideIfCero($('#field_datos_del_evaluador_generico_entidad_evaluadora_2_monto_a_pagar'));
  						hideIfCero($('#field_datos_del_evaluador_generico_entidad_evaluadora_3_monto_a_pagar'));
  						hideIfCero($('#field_datos_del_evaluador_generico_entidad_evaluadora_4_monto_a_pagar'));
  						hideIfCero($('#field_datos_del_evaluador_generico_entidad_evaluadora_5_monto_a_pagar'));
  						hideIfCero($('#field_datos_del_evaluador_generico_entidad_evaluadora_6_monto_a_pagar'));
  						hideIfCero($('#field_datos_del_evaluador_generico_entidad_evaluadora_7_monto_a_pagar'));
  						hideIfCero($('#field_datos_del_evaluador_generico_entidad_evaluadora_8_monto_a_pagar'));
  						hideIfCero($('#field_datos_del_evaluador_generico_entidad_evaluadora_9_monto_a_pagar'));
  						hideIfCero($('#field_datos_del_evaluador_generico_entidad_evaluadora_10_monto_a_pagar'));
  						hideIfCero($('#field_datos_del_evaluador_generico_entidad_evaluadora_11_monto_a_pagar'));
  						hideIfCero($('#field_datos_del_evaluador_generico_entidad_evaluadora_12_monto_a_pagar'));
  						hideIfCero($('#field_datos_del_evaluador_generico_entidad_evaluadora_13_monto_a_pagar'));
  						hideIfCero($('#field_datos_del_evaluador_generico_entidad_evaluadora_14_monto_a_pagar'));
  						});
  });
