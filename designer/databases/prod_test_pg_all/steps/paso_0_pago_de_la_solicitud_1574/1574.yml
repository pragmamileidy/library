--- 
id: 1574
name: Paso 0 - Pago de la Solicitud
label: Pago de la Solicitud
description: "Ingrese los datos del Pago de la Solicitud<br>\r\n\
  Usted debe pagar B/.4.00 en timbres y B/.10.00 por revisi\xC3\xB3n del Ministerio de Obras P\xC3\xBAblicas"
fill_step_id: 771
created_at: 2014-01-20 16:31:22 Z
updated_at: 2014-01-20 16:31:22 Z
include: "{\"3450\":{\"2585\":{\"3114\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2924\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2586\":{\"3114\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2924\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2587\":{\"3114\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2924\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2590\":{\"3114\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2924\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2591\":{\"3114\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2924\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2599\":{\"3114\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2924\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2600\":{\"3114\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2924\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2601\":{\"3114\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2924\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2602\":{\"3114\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2924\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2603\":{\"3114\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2924\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2604\":{\"3114\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2924\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2605\":{\"3114\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2924\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2606\":{\"3114\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2924\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2607\":{\"3114\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2924\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2608\":{\"3114\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2924\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2589\":{\"2892\":{\"views\":\"default\",\"enabled\":\"disabled\"}}},\"3457\":{\"1824\":{\"1366\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1367\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1368\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1369\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1370\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"1371\":{\"views\":\"default\",\"enabled\":\"enabled\"},\"2544\":{\"views\":\"default\",\"enabled\":\"enabled\"}}},\"3458\":{\"2596\":{\"2164\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2165\":{\"views\":\"default\",\"enabled\":\"disabled\"}}}}"
allowed_next_to_steps: ""
allowed_back_to_steps: ""
controls: ,close,close_and_save,save,submit
on_becoming: |
  ########Pago y Nombre de Entidades P4
  dat = @application["id"].to_s
  result = WebserviceConsumer.get('/preconfigured_services/get_application_config.json?id='+dat).parsed_response
  entidades=[]
  result["response"]["EntidadesEvaluadorasProceso4"].each do |le| 
  	entidades<<le.last["evaluacion_de_la_entidad"]
  end
  
  _costoTotal= 0
  15.times do |i|
  entidade = form_data.get("asignacion_de_entidades.entidad_evaluadora.entidad_evaluadora_municipio_check_p4")
  entidade = JSON.parse(entidade)
  
   if entidades && entidades[i] && entidade.include?(entidades[i]["entidad"])
    _costoTotal += entidades[i]["coste"].to_i
    _costo = entidades[i]["coste"]
    _nombre = entidades[i]["entidad"]
  
    form_data.set("entidad_evaluadora.entidad_evaluadora_#{i}.monto_a_pagar", _costo)
    form_data.set("entidad_evaluadora.entidad_evaluadora_#{i}.nombre_de_la_entidad", _nombre)
   end
  end
  form_data.set("entidad_evaluadora.monto_total.monto_total", _costoTotal)
  form_data.set("datos_de_pago.datos_de_pago.monto_del_pago", _costoTotal)

on_transition: |-
  fecha_pago = form_data.get("datos_de_pago.datos_de_pago.fecha_del_pago") 
  
  if (fecha_pago.to_date > Date.today)
  	transition_errors << " La fecha del recibo del pago no debe ser mayor a la fecha actual"
  
  end
views: 
back_step: ""
next_step: ""
position: 0
ajax_calls: "$(function() {\r\n        $('input[name=\"[field][datos_de_pago_datos_de_pago_utilizo_banca_en_linea]\"]').change(function() {\r\n                if ($('input[name=\"[field][datos_de_pago_datos_de_pago_utilizo_banca_en_linea]\"]:checked').val() == \"S\xC3\x8D\")\r\n                {\r\n                    $('input[name=\"[field][datos_de_pago_datos_de_pago_pago_manual_confirmado]\"]').attr(\"disabled\", \"disabled\");\r\n\
  \t\t\t\t    $('input:radio[name=\"[field][datos_de_pago_datos_de_pago_pago_manual_confirmado]\"][value=\"No\"]:first').attr('checked', true);\r\n                }\r\n                else\r\n                {\r\n\
  \t\t\t\t    $('input[name=\"[field][datos_de_pago_datos_de_pago_pago_manual_confirmado]\"]').removeAttr(\"disabled\");\r\n\
  \t\t\t\t\t$('input:radio[name=\"[field][datos_de_pago_datos_de_pago_pago_manual_confirmado]\"][value=\" \"]:first').attr('checked', true);\r\n                    \r\n                }\r\n        });\r\n\
  });\r\n\
  \r\n\
  \r\n\
  $( function() {\r\n\
  \t\r\n\
  \t$(document).ready(function(){\r\n\
  \r\n\
  \t\tfunction partContainer(obj) { \r\n\
  \t\t\treturn obj.parent().parent().parent().parent().parent().children(); \r\n\
  \t\t};\r\n\
  \t\tfunction valueIsCero(obj) { \r\n\
  \t\t\treturn ((obj.val() == \"\") || (obj.val() == 0)); \r\n\
  \t\t};\r\n\
  \t\tfunction hideIfCero(obj) { \r\n\
  \t\t\tif( valueIsCero(obj) ){ partContainer(obj).hide(); partContainer(obj).parent().hide(); };\r\n\
  \t\t};\r\n\
  \r\n\
  \t\thideIfCero($('#field_entidad_evaluadora_entidad_evaluadora_0_monto_a_pagar'));\r\n\
  \t\thideIfCero($('#field_entidad_evaluadora_entidad_evaluadora_1_monto_a_pagar'));\r\n\
  \t\thideIfCero($('#field_entidad_evaluadora_entidad_evaluadora_2_monto_a_pagar'));\r\n\
  \t\thideIfCero($('#field_entidad_evaluadora_entidad_evaluadora_3_monto_a_pagar'));\r\n\
  \t\thideIfCero($('#field_entidad_evaluadora_entidad_evaluadora_4_monto_a_pagar'));\r\n\
  \t\thideIfCero($('#field_entidad_evaluadora_entidad_evaluadora_5_monto_a_pagar'));\r\n\
  \t\thideIfCero($('#field_entidad_evaluadora_entidad_evaluadora_6_monto_a_pagar'));\r\n\
  \t\thideIfCero($('#field_entidad_evaluadora_entidad_evaluadora_7_monto_a_pagar'));\r\n\
  \t\thideIfCero($('#field_entidad_evaluadora_entidad_evaluadora_8_monto_a_pagar'));\r\n\
  \t\thideIfCero($('#field_entidad_evaluadora_entidad_evaluadora_9_monto_a_pagar'));\r\n\
  \t\thideIfCero($('#field_entidad_evaluadora_entidad_evaluadora_10_monto_a_pagar'));\r\n\
  \t\thideIfCero($('#field_entidad_evaluadora_entidad_evaluadora_11_monto_a_pagar'));\r\n\
  \t\thideIfCero($('#field_entidad_evaluadora_entidad_evaluadora_12_monto_a_pagar'));\r\n\
  \t\thideIfCero($('#field_entidad_evaluadora_entidad_evaluadora_13_monto_a_pagar'));\r\n\
  \t\thideIfCero($('#field_entidad_evaluadora_entidad_evaluadora_14_monto_a_pagar'));\r\n\
  \t});\r\n\
  });"
