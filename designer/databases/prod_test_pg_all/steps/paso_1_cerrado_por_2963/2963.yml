--- 
id: 2963
name: Paso 1 - Cerrado por
label: Cerrado por
description: Cerrado por
fill_step_id: 1591
created_at: 2014-10-09 22:17:33 Z
updated_at: 2014-11-28 22:28:22 Z
include: "{\"4496\":{\"580\":{\"1981\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"528\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"529\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"530\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"537\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"926\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"3614\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"3615\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"3616\":{\"views\":\"default\",\"enabled\":\"disabled\"}}},\"4497\":{\"595\":{\"567\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"566\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"597\":{\"572\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"805\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1123\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"631\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"594\":{\"views\":\"default\",\"enabled\":\"disabled\"}}},\"4604\":{\"3149\":{\"3605\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"3151\":{\"1981\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"528\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"529\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"530\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"537\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"926\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"545\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"546\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2983\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"763\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"3152\":{\"2979\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"2980\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"3154\":{\"567\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1282\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"3342\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"3153\":{\"572\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"805\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"585\":{\"views\":\"default\",\"enabled\":\"disabled\"}}},\"4500\":{\"2911\":{\"210\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2701\":{\"2940\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2912\":{\"210\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2702\":{\"2937\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2700\":{\"2938\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2927\":{\"210\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2928\":{\"210\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"2929\":{\"210\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"3246\":{\"210\":{\"views\":\"default\",\"enabled\":\"disabled\"}},\"3247\":{\"210\":{\"views\":\"default\",\"enabled\":\"disabled\"}}},\"4606\":{\"1710\":{\"1401\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1402\":{\"views\":\"default\",\"enabled\":\"disabled\"}}},\"4506\":{\"1710\":{\"1401\":{\"views\":\"default\",\"enabled\":\"disabled\"},\"1402\":{\"views\":\"default\",\"enabled\":\"enabled\"}}}}"
allowed_next_to_steps: ""
allowed_back_to_steps: ""
controls: ,close,close_and_save,save,submit
on_becoming: |-
  _idagente = @task["agent_id"].to_s
  
  result = WebserviceConsumer.get( '/preconfigured_services/get_user_info.xml?agent_id=' + "#{_idagente}" + '&include_all=true').parsed_response
  _hash = result["hash"]
  _agente = _hash["response"]
  
  
  form_data.set("cerrado_por.datos_del_funcionario_generico.usuario", _agente["name"])
on_transition: ""
views: 
back_step: ""
next_step: ""
position: 0
ajax_calls: "$(document).ready(function(){\r\n\
  \t$.each( $('[id*=datos_de_autores_]'), function(index, campo) {\t\r\n\
  \t\tvar pos = (this.id).match(/_instance_[\\d][\\d]/);\r\n\
  \t\tif (pos == null){\r\n\
  \t\t  pos = (this.id).match(/_instance_[\\d]/);\r\n\
  \t\t}\r\n\
  \t\tvar InicioRuta = \"#field_datos_de_autores\";\r\n\
  \t\tvar TipoDoc = \"_tipo_de_identificacion_tipo_identificacion_texto\";\r\n\
  \t\tvar NroDoc = \"_datos_de_la_persona_cedula_pasaporte\";\r\n\
  \t\tvar NroRuc = \"_datos_de_la_empresa_ruc\";\r\n\
  \t\tvar Seudonimo = \"_seudonimo_indique_seudonimo\"\r\n\
  \t \tvar coincide = InicioRuta.concat(pos);\r\n\
  \t\tvar TipoDocu = coincide.concat(TipoDoc);\r\n\
  \t\tvar ced = coincide.concat(NroDoc);\r\n\
  \t\tvar ruc =  coincide.concat(NroRuc);\r\n\
  \t\tvar seu = coincide.concat(Seudonimo);\r\n\
  \t\t\r\n\
  //#::::::::::::: Datos a deshabilitar en persona natural ::::::::::::::::://\r\n\
  \r\n\
  \t\tvar doc = \"_datos_de_la_persona_cedula_pasaporte\";\r\n\
  \t\tvar nom = \"_datos_de_la_persona_primer_nombre\";\r\n\
  \t\tvar nom2 = \"_datos_de_la_persona_segundo_nombre\";\r\n\
  \t\tvar nom3 = \"_datos_de_la_persona_primer_apellido\";\r\n\
  \t\tvar nom4 = \"_datos_de_la_persona_segundo_apellido\";\r\n\
  \t\tvar fec = \"_datos_de_la_persona_fecha_de_nacimiento\";\r\n\
  \t\tvar nac = \"_datos_de_la_persona_nacionalidad\";\r\n\
  \t\tvar edad = \"_datos_de_la_persona_edad\";\r\n\
  \t\tvar dir = \"_informacion_de_residencia_localizacion_direccion\";\r\n\
  \t\tvar tlf = \"_informacion_de_residencia_localizacion_numero_de_telefono\";\r\n\
  \t\tvar email = \"_informacion_de_residencia_localizacion_correo_electronico\";\r\n\
  \t\tvar documento = coincide.concat(doc);\r\n\
  \t\tvar nombre1 =  coincide.concat(nom);\r\n\
  \t\tvar nombre2 =  coincide.concat(nom2);\r\n\
  \t\tvar nombre3 =  coincide.concat(nom3);\r\n\
  \t\tvar nombre4 = coincide.concat(nom4);\r\n\
  \t\tvar fecha = coincide.concat(fec);\r\n\
  \t\tvar nacionalidad = coincide.concat(nac);\r\n\
  \t\tvar telefono = coincide.concat(tlf);\r\n\
  \t\tvar correo = coincide.concat(email);\r\n\
  \t\tvar edad1 = coincide.concat(edad);\r\n\
  \t\tvar direccion = coincide.concat(dir);\r\n\
  \t\tif($(TipoDocu).val() == 'C\xC3\xA9dula' || $(TipoDocu).val() == 'Pasaporte'){ \r\n\
  \t\t\t$(ruc).parents(\".part-box\").hide();\r\n\
  \t\t}else {\r\n\
  \r\n\
  \t\t\t$(ced).parents(\".part-box\").hide();\r\n\
  \t\t\t$(seu).parents(\".part-box\").hide();\r\n\
  \t\t\t//$(telefono).parents(\".field-box\").hide();\r\n\
  \t\t\t$(correo).parents(\".field-box\").hide();\r\n\
  \t\t}\r\n\
  \t\tif($(TipoDocu).val() == 'C\xC3\xA9dula'){\t\t\t\r\n\
  \t\t\t\r\n\
  \t\t\t$(nombre1).attr(\"disabled\",\"disabled\");\r\n\
  \t\t\t$(nombre2).attr(\"disabled\",\"disabled\");\r\n\
  \t\t\t$(nombre3).attr(\"disabled\",\"disabled\");\r\n\
  \t\t\t$(nombre4).attr(\"disabled\",\"disabled\");\r\n\
  \t\t\t$(fecha).attr(\"disabled\",\"disabled\");\r\n\
  \t\t\t$(edad1).attr(\"disabled\",\"disabled\");\r\n\
  \t\t\t$(nacionalidad).attr(\"disabled\",\"disabled\");\t\t\t\r\n\
  \t\t}\r\n\
  \r\n\
  \t\tif($(TipoDocu).val() == 'Pasaporte' && $(telefono).val() ==''){\t\r\n\
  \t\t\t\r\n\
  \t\t\t$(nombre1).val('');\r\n\
  \t\t\t$(nombre2).val('');\r\n\
  \t\t\t$(nombre3).val('');\r\n\
  \t\t\t$(nombre4).val('');\r\n\
  \t\t\t$(fecha).val('');\r\n\
  \t\t\t$(edad1).val('');\r\n\
  \t\t\t$(nacionalidad).val(''); \r\n\
  \t\t\t$(direccion).val('');\t\t\t\r\n\
  \t\t}\t\r\n\
  \r\n\
  \t\tif($(TipoDocu).val() == ''){\r\n\
  \t\t\t$(ced).parents(\".section-box\").hide();\r\n\
  \t\t}\t\r\n\
  \t\t$(TipoDocu).parents(\".section-box\").next().hide();\r\n\
  \r\n\
  //::::::::::::::::::::::: VALIDACION SEUDONIMO:::::::::::::::::::://\r\n\
  \t\t\t   \r\n\
  \t\tvar inicio = \"input[name='[field][datos_de_autores\";\r\n\
  \t\tvar fin = \"_seudonimo_seudonimo][]']\";\r\n\
  \t\tvar medio = inicio.concat(pos);\r\n\
  \t\tvar palabra = medio.concat(fin);\r\n\
  \t\tvar detal = \"_seudonimo_indique_seudonimo\";\r\n\
  \t\tvar detalle = coincide.concat(detal);\r\n\
  \r\n\
  \t\t$(palabra).click(function(event){\r\n\
  \t\t\t$(this).each(function(){\r\n\
  \t\t\t\tif (this.checked) {\r\n\
  \t\t\t\t\tvar dato1 = $(this).val();\r\n\
  \t\t\t\t\tif(dato1 == 'Seudonimo'){\r\n\
  \t\t\t\t\t\t$(detalle).removeAttr(\"disabled\");\r\n\
  \t\t\t\t\t}\r\n\
  \t\t\t\t}\r\n\
  \t\t\t\tif (!this.checked) {\r\n\
  \t\t\t\t\tvar dato1 = $(this).val();\r\n\
  \t\t\t\t\tif(dato1 == 'Seudonimo'){\r\n\
  \t\t\t\t\t\t$(detalle).val('');\r\n\
  \t\t\t\t\t\t$(detalle).attr(\"disabled\",\"disabled\");\r\n\
  \t\t\t\t\t}\r\n\
  \t\t\t\t}\r\n\
  \t\t\t});\r\n\
  \t\t});\t\r\n\
  \t});\r\n\
  });\r\n\
  \r\n\
  //::::::::::::::::Calcular Edad:::::::::::::::::::::::::::::://\r\n\
  $(document).ready(function(){\r\n\
  $.each( $('[id*=datos_de_autores_]'), function(index, campo) {\r\n\
  var pos = (this.id).match(/_instance_[\\d][\\d]/);\r\n\
  if (pos == null){\r\n\
  pos = (this.id).match(/_instance_[\\d]/);\r\n\
  }\r\n\
  var iniciorut = \"#field_datos_de_autores\";\r\n\
  var fecha = \"_datos_de_la_persona_fecha_de_nacimiento\";\r\n\
  var edad = \"_datos_de_la_persona_edad\";\r\n\
  var coincide = iniciorut.concat(pos);\r\n\
  var Fnac = coincide.concat(fecha);\r\n\
  var Edad1 = coincide.concat(edad);\r\n\
  \r\n\
  $(Fnac).change(function(){\r\n\
  var fecha1 = $(Fnac).val();\r\n\
  var values = fecha1.split(\"-\");\r\n\
  var dia = values[0];\r\n\
  var mes = values[1];\r\n\
  var ano = values[2];\r\n\
  \r\n\
  //::: OBTENER LOS VALORES ACTUALES ::://\r\n\
  var fecha_hoy = new Date();\r\n\
  var ahora_ano = fecha_hoy.getYear();\r\n\
  var ahora_mes = fecha_hoy.getMonth();\r\n\
  var ahora_dia = fecha_hoy.getDate();\r\n\
  //::: REALIZAR EL CALCULO ::://\r\n\
  var edad2 = (ahora_ano + 1900) - ano;\r\n\
  if ( ahora_mes < (mes - 1)){\r\n\
  edad2--;\r\n\
  }\r\n\
  if (((mes - 1) == ahora_mes) && (ahora_dia < dia)){\r\n\
  edad2--;\r\n\
  }\r\n\
  if (((mes) == ahora_mes) && (ahora_dia < dia)){\r\n\
  edad2--;\r\n\
  }\r\n\
  if (edad2 > 1900){\r\n\
  edad2 -= 1900;\r\n\
  }\r\n\
  $(Edad1).val(edad2);\r\n\
  });\r\n\
  });\r\n\
  });"
